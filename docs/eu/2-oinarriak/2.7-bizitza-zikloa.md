# 2.7 Konponenteen Bizitza Zikloa


Vue konponente baten bizitza zikloa garatzaile guztiek ulertu behar duten oinarrizko kontzeptua da, aplikazio sendo eta eraginkorrak sortzeko. Ziklo honek Vue osagai bakoitzak igarotzen dituen faseak definitzen ditu, sortzetik suntsipenera arte.

## Bizitza Zikloko Hooks-ak

Vue-k "hooks" edo kako batzuk eskaintzen ditu, osagaien bizitza zikloko momentu jakin batzuetan kodea exekutatzeko aukera ematen digutenak. Garrantzitsuenak hauek dira:

### 1. Sortzea
- **beforeCreate**: Instantzia hasi ondoren exekutatzen da, erreaktibotasuna injektatu aurretik.
- **created**: Instantzia sortu ondoren deitzen da. Une honetan, propietate erreboteak, kalkulatutako propietateak, metodoak eta begiraleak konfiguratuta daude.

### 2. DOM-ean Muntatzea
- **beforeMount**: Osagaia DOM-ean muntatu aurretik exekutatzen da.
- **mounted**: Osagaia DOM-ean muntatu ondoren deitzen da. Une honetan, `this.$el` bidez atzitu dezakezu DOM-era.

### 3. Eguneratzea
- **beforeUpdate**: Datuak aldatzen direnean exekutatzen da, DOM-a eguneratu aurretik.
- **updated**: Datuen aldaketaren ondorioz DOM-a eguneratu ondoren deitzen da.

### 4. Desmuntatzea
- **beforeUnmount**: Osagaia desmuntatu aurretik exekutatzen da.
- **unmounted**: Osagaia desmuntatu ondoren deitzen da.

## Bizitza Zikloko Diagrama

```
Vue osagai berria
      │
      ▼
┌─────────────┐
│ beforeCreate │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│   created   │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ beforeMount │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│   mounted   │
└──────┬──────┘
       │
       ▼
┌─────────────────┐
│ Datu berriak?   │───Bai──► beforeUpdate ─► updated
└─────────────────┘   │
       Ez             │
       │             ▼
       │       ┌─────────────┐
       │       │  updated    │
       │       └─────────────┘
       │             │
       ▼             ▼
┌─────────────┐     │
│ beforeUnmount│◄────┘
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  unmounted  │
└─────────────┘
```

## Adibide Praktikoa

```javascript
import { ref, onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } from 'vue'

export default {
  setup() {
    const mezua = ref('Kaixo Vue!')

    console.log('setup exekutatua (created baliokidea)')

    onBeforeMount(() => {
      console.log('Osagaia muntatu aurretik')
    })

    onMounted(() => {
      console.log('Osagaia DOM-ean muntatuta')
    })

    onBeforeUpdate(() => {
      console.log('DOM-a eguneratu aurretik')
    })

    onUpdated(() => {
      console.log('DOM-a eguneratuta')
    })

    onBeforeUnmount(() => {
      console.log('Osagaia desmuntatu aurretik')
    })

    onUnmounted(() => {
      console.log('Osagaia desmuntatuta')
    })

    return { mezua }
  }
}
```

## Noiz Erabili Hook Bakoitza

- **created**: AJAX eskaerak edo DOM-era sarbide behar ez duten hasierako konfigurazioak egiteko ideala.
- **mounted**: DOM-era sarbidea behar duten eragiketetarako edo hirugarrenen liburutegiak hasieratzeko egokia.
- **updated**: Datuen aldaketaren ondorioz DOM-a eguneratu ondoren egin beharreko eragiketetarako erabilgarria.
- **beforeUnmount**: Tenporizadoreak, eskaerak edo gertaeren harpidetzak garbitzeko egokia.

## Errendimenduaren Aholkuak

1. Saiatu operazio astun sinkronoak ekiditen `created` edo `mounted`-en, hari nagusia blokea dezaketelako.
2. Erabili `nextTick` datuen aldaketaren ondoren Vue-k DOM-a eguneratzea amaitzea itxaroteko baduzu.
3. Garbitu beti gertaen entzuleak eta tenporizadoreak `beforeUnmount`-en, memoria-ihesak saihesteko.

## Ariketa Praktikoa

Sortu segidako osagai hau:
1. Segundoro handitzen den kontagailu bat erakutsi
2. Erregistratu kontsolan bizitza zikloko etapa bakoitza
3. Baimendu kontagailua pausatzea/berrestea
4. Garbitu behar bezala desmuntatzean

```vue
<template>
  <div>
    <h2>Kontagailua: {{ kontagailua }}</h2>
    <button @click="aldatuPausa">
      {{ pausatuta ? 'Berreztu' : 'Pausatu' }}
    </button>
  </div>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from 'vue'

const kontagailua = ref(0)
const tartea = ref(null)
const pausatuta = ref(false)

function hasiKontagailua() {
  tartea.value = setInterval(() => {
    if (!pausatuta.value) {
      kontagailua.value++
    }
  }, 1000)
}

function garbituKontagailua() {
  if (tartea.value) {
    clearInterval(tartea.value)
    tartea.value = null
  }
}

function aldatuPausa() {
  pausatuta.value = !pausatuta.value
}

console.log('Osagaia sortuta')

onMounted(() => {
  console.log('Osagaia muntatuta')
  hasiKontagailua()
})

onBeforeUnmount(() => {
  console.log('Desmuntatu aurretik')
  garbituKontagailua()
})
</script>
```

## Ohiko Galderak

**Zein da `created` eta `mounted` arteko aldea?**

   - `created` instantzia sortu ondoren deitzen da, baina oraindik ez da DOM-ean sartu.
   - `mounted` osagaia DOM-ean sartu ondoren deitzen da.

**Noiz erabili behar dut `beforeUnmount`?**
Erabili `beforeUnmount` memoria-ihesak eragin ditzaketen baliabideak garbitzeko, hala nola:

   - `setTimeout` edo `setInterval` bidezko tenporizadoreak
   - Gertaera globaletarako harpidetzak
   - WebSocket konexioak
   - Askatu beharreko beste edozein baliabide

**Erabil al dezaket async/await bizitza zikloko hooks-etan?**
Bai, baina kontuan izan bizitza zikloak promesa ebatzi arte itxarongo ez duela. Errendimendu asinkronoa behar baduzu, erabili `onMounted` Composition API-a edo kudeatu logika asinkronoa beste modu batean.

## Hurrengo Urratsa

Orain Vue-ren osagaien bizitza zikloari buruz ikasi duzula, hurrengo pausoa Vue 3-ko erantzunkortasun-sistemari buruz sakontzea da.

[Hurrengoa: Erantzunkortasuna →](./2.9-erantzunkortasuna.md)
