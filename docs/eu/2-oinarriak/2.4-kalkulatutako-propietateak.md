# 2.5 Kalkulatutako Propietateak

Kalkulatutako propietateak beste propietate erreaktiboetan oinarrituta automatikoki kalkulatzen diren balioak dira. Eragiketa konplexuak egiteko edo datuak modu eraginkorrean iragazteko ideala dira.

## Oinarrizko Kontzeptuak

### Zer da kalkulatutako propietate bat?

Kalkulatutako propietatea beste propietate erreaktiboetan oinarritutako balioa itzultzen duen funtzio bat da. Vue-k bere menpekotasunak automatikoki jarraitzen ditu eta beharrezkoa denean balioa berriro kalkulatzea kudeatzen du.

### Sintaxi Oinarrizkoa

```html
<template>
  <div>
    <p>Izen osoa: {{ izenOsoa }}</p>
    <p>Izena maiuskulaz: {{ izenMaiuskulatan }}</p>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue';

const izena = ref('Ane');
const abizena = ref('Garcia');

// Kalkulatutako propietate oinarrizkoa
const izenOsoa = computed(() => {
  return `${izena.value} ${abizena.value}`;
});

// Beste kalkulatutako propietate baten menpe dagoen propietatea
const izenMaiuskulatan = computed(() => {
  return izenOsoa.value.toUpperCase();
});
</script>
```

## Ezaugarri Nagusiak

### 1. Cache Automatikoa

Kalkulatutako propietateek beren emaitzak cachean gordetzen dituzte eta beren menpekotasun erreaktiboetako bat aldatzen denean bakarrik berriro kalkulatzen dira.

**Cache-aren adibidea:**

```javascript
const orain = computed(() => {
  // Propietate hau soilik berriro kalkulatuko da bertara sartzen denean
  // eta bere menpekotasunetako bat aldatu bada
  return new Date().toLocaleTimeString();
});
```

### 2. Irakurtzeko soilik diren kalkulatutako propietateak

Berez, kalkulatutako propietateak irakurtzeko soilik dira. Idazteko moduko propietate bat behar baduzu, getter eta setter bat eman ditzakezu.

```javascript
const izenOsoa = computed({
  // getter
  get() {
    return `${izena.value} ${abizena.value}`;
  },
  // setter
  set(balioBerria) {
    const [izenBerria, ...abizenak] = balioBerria.split(' ');
    izena.value = izenBerria;
    abizena.value = abizenak.join(' ');
  }
});

// Orain hau egin dezakezu:
// izenOsoa.value = 'Mikel Otegi Lopez';
```

### 3. Praktika Onak

1. **Saihestu albo-ondorioak**: Kalkulatutako propietateek ez lukete albo-ondoriorik izan behar. Ez egin eskaera asinkronorik ezta DOM-a aldatu haien barruan.

2. **Ez aldatu daturik**: Ez aldatu estaturik kalkulatutako propietate baten barruan. Erabili metodoak edo watchers horretarako.

3. **Mantendu sinpletasuna**: Kalkulatutako propietate bat gehiegi konplexu bihurtzen bada, kontuan izan kalkulatutako propietate txikiagoetan banatzea.

## Adibide Praktikoa: Erosketa Saskia

```html
<template>
  <div class="saskia">
    <h2>Erosketa Saskia</h2>
    
    <div v-for="elementua in elementuak" :key="elementua.id" class="elementua">
      <span>{{ elementua.izena }}</span>
      <input 
        type="number" 
        v-model.number="elementua.kopurua" 
        min="1"
        @change="eguneratuKopurua(elementua)"
      >
      <span>{{ formatuPrezioa(elementua.prezioa * elementua.kopurua) }}</span>
    </div>
    
    <div class="guztira">
      <strong>Guztira:</strong> {{ formatuPrezioa(guztira) }}
    </div>
    <div class="beherapena" v-if="beherapena > 0">
      <strong>Beherapena:</strong> -{{ formatuPrezioa(beherapena) }}
    </div>
    <div class="ordaindu" v-if="guztira > 0">
      <strong>Ordaindu beharrekoa:</strong> {{ formatuPrezioa(ordainduBeharrekoa) }}
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue';

const elementuak = ref([
  { id: 1, izena: 'Liburua', prezioa: 15.99, kopurua: 1 },
  { id: 2, izena: 'Arkatza', prezioa: 1.50, kopurua: 3 },
  { id: 3, izena: 'Koadernoa', prezioa: 4.99, kopurua: 2 },
]);

// Kalkulatutako propietateak
const guztira = computed(() => {
  return elementuak.value.reduce((total, elementua) => {
    return total + (elementua.prezioa * elementua.kopurua);
  }, 0);
});

const beherapena = computed(() => {
  // %10eko beherapena 50€-tik gorako erosketetarako
  return guztira.value > 50 ? guztira.value * 0.1 : 0;
});

const ordainduBeharrekoa = computed(() => {
  return guztira.value - beherapena.value;
});

// Metodoak
const eguneratuKopurua = (elementua) => {
  if (elementua.kopurua < 1) {
    elementua.kopurua = 1;
  }
};

const formatuPrezioa = (prezioa) => {
  return `${prezioa.toFixed(2)} €`;
};
</script>

<style scoped>
.saskia {
  max-width: 500px;
  margin: 0 auto;
  padding: 20px;
  border: 1px solid #ddd;
  border-radius: 8px;
}

.elementua {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px;
  border-bottom: 1px solid #eee;
}

.elementua:last-child {
  border-bottom: none;
}

input[type="number"] {
  width: 60px;
  text-align: center;
  padding: 5px;
}

.guztira, .beherapena, .ordaindu {
  text-align: right;
  margin-top: 15px;
  padding-top: 10px;
  border-top: 1px solid #eee;
}

.ordaindu {
  font-size: 1.2em;
  color: #2c3e50;
  font-weight: bold;
}
</style>
```

## Ariketa Praktikoa

1. Sortu kalkulatutako propietate bat produktu baten prezioa eta kantitatea biderkatzen dituena.
2. Gehitu kalkulatutako propietate bat produktu bakoitzaren guztizko prezioa erakusteko.
3. Sortu kalkulatutako propietate bat saskiko guztizko prezioa kalkulatzeko.
4. Gehitu beherapen bat %15ekoa 100€-tik gorako erosketetarako.
5. Erakutsi beherapenaren zenbatekoa eta guztizko prezioa beherapenarekin.

## Laburpena

- **Kalkulatutako propietateak** datuak prozesatzeko eta formatu egokian erakusteko balio dute.
- **Cache-aren** abantaila dute, hau da, beren menpekotasunak aldatzen ez diren bitartean ez dute berriro exekutatzen.
- **Irakurtzeko soilik** diren arren, setter bat defini daiteke idazteko aukera emateko.
- **Ez dute** inoiz izan behar **albo-ondoriorik** (API deiak, DOM aldaketak, etc.).

## Berrikusteko Galderak

1. Zein da metodo baten eta kalkulatutako propietate baten arteko alderik nagusiena?
2. Noiz berriro kalkulatzen da kalkulatutako propietate bat?
3. Zergatik da garrantzitsua kalkulatutako propietateek ez izatea albo-ondoriorik?
4. Nola sortuko zenuke idazteko moduko kalkulatutako propietate bat?
5. Zein da kalkulatutako propietateen cache-aren abantaila?

## Baliabide Gehigarriak

- [Kalkulatutako Propietateen Dokumentazio Ofiziala](https://vuejs.org/guide/essentials/computed.html)
- [Erreaktibotasunari buruzko Gida Sakona](https://vuejs.org/guide/extras/reactivity-in-depth.html)
- [Vue Mastery: Kalkulatutako Propietateak](https://www.vuemastery.com/courses/vue-3-essentials/computed-properties)

## Hurrengo Urratsa

Orain kalkulatutako propietateei buruz ikasi duzunez, hurrengo pausoa da Vue-n gertaeren kudeaketa ikastea.

[Hurrengoa: Gertaeren Kudeaketa →\](./2.5-gertaerak.md)
